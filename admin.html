<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Koning Dodo Admin</title>
<style>
  body {
    font-family: 'Arial', sans-serif;
    background: #121212;
    color: #eee;
    margin: 0;
    padding: 20px;
  }
  h1 {
    color: #ff8c00;
    margin-bottom: 20px;
  }
  input, button {
    font-size: 14px;
    padding: 6px 10px;
    margin: 5px 0;
    border-radius: 4px;
    border: none;
  }
  input {
    width: 200px;
  }
  button {
    background-color: #ff8c00;
    color: #121212;
    cursor: pointer;
  }
  button:hover {
    background-color: #ffa733;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }
  th, td {
    border: 1px solid #333;
    padding: 6px;
    text-align: left;
  }
  th {
    background-color: #1e3a1e;
    color: #fff;
  }
  tr:nth-child(even) {
    background-color: #1a1a1a;
  }
  #dashboard > button {
    margin-right: 10px;
    margin-bottom: 10px;
  }
</style>
</head>
<body>

<h1>Koning Dodo Admin Dashboard</h1>

<div id="loginDiv">
  <p>Voer admin wachtwoord in:</p>
  <input type="password" id="adminPass" placeholder="Wachtwoord">
  <button onclick="login()">Login</button>
  <p id="loginMsg" style="color:red;"></p>
</div>

<div id="dashboard" style="display:none;">
  <button onclick="loadBets()">Bets laden</button>
  <button onclick="resolveAll()">Alle Bets resolven</button>
  <button onclick="loadStats()">Stats laden</button>

  <h2>Alle Bets</h2>
  <div id="betsContainer"></div>

  <h2>Stats</h2>
  <div id="statsContainer"></div>
</div>

<script>
const ADMIN_PASSWORD = "admin123";

function login() {
  const pass = document.getElementById("adminPass").value;
  if(pass === ADMIN_PASSWORD) {
    document.getElementById("loginDiv").style.display = "none";
    document.getElementById("dashboard").style.display = "block";
  } else {
    document.getElementById("loginMsg").textContent = "Verkeerd wachtwoord!";
  }
}

async function loadBets() {
  try {
    const res = await fetch("/api/bets");
    const data = await res.json();
    const container = document.getElementById("betsContainer");
    if(data.ok && data.bets) {
      let html = "<table><tr><th>User</th><th>Pick</th><th>Stake</th><th>Odds</th><th>Status</th></tr>";
      data.bets.forEach(b => {
        html += `<tr>
          <td>${b.user}</td>
          <td>${b.pick}</td>
          <td>€${b.stake.toLocaleString()}</td>
          <td>${b.odds}</td>
          <td>${b.status || "open"}</td>
        </tr>`;
      });
      html += "</table>";
      container.innerHTML = html;
    } else {
      container.textContent = "Geen bets gevonden of fout bij laden.";
    }
  } catch(err) {
    document.getElementById("betsContainer").textContent = "Fout bij laden bets: " + err.message;
  }
}

async function resolveAll() {
  try {
    const res = await fetch("/api/resolve-all", { method: "POST" });
    const data = await res.json();
    if(data.ok) {
      alert("Bets succesvol geresolved!");
      loadBets();
      loadStats();
    } else {
      alert("Fout bij resolven: " + data.error);
    }
  } catch(err) {
    alert("Fout bij resolven: " + err.message);
  }
}

async function loadStats() {
  try {
    const res = await fetch("/api/stats");
    const data = await res.json();
    const container = document.getElementById("statsContainer");
    if(data.ok && data.stats) {
      let html = "<table><tr><th>User</th><th>Total Bets</th><th>Wins</th><th>Losses</th><th>Profit</th></tr>";
      Object.entries(data.stats).forEach(([user, stat]) => {
        html += `<tr>
          <td>${user}</td>
          <td>${stat.totalBets}</td>
          <td>${stat.wins}</td>
          <td>${stat.losses}</td>
          <td>€${stat.profit.toLocaleString()}</td>
        </tr>`;
      });
      html += "</table>";
      container.innerHTML = html;
    } else {
      container.textContent = "Geen stats gevonden of fout bij laden.";
    }
  } catch(err) {
    document.getElementById("statsContainer").textContent = "Fout bij laden stats: " + err.message;
  }
}
</script>

</body>
</html>
